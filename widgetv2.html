<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Live Commentary Widget</title>
</head>
<body>
  <div class="commentary-widget">
    <button id="playButton" aria-label="Play">
      ▶️ Play Commentary
    </button>
    <div id="commentaryLine">
      <strong>Commentary:</strong> <span id="text">Press play for live commentary</span>
    </div>
  </div>

  <script>
    const playButton = document.getElementById("playButton");
    const commentaryLine = document.getElementById("text");

    const commentaries = [
      {
        time: "84'",
        text: "GOAL! Saliba heads home from the corner!",
        audio: "https://briwild79.github.io/football-commentary-audio/commentary_82.mp3"
      },
      {
        time: "85'",
        text: "United pushing forward desperately",
        audio: "https://briwild79.github.io/football-commentary-audio/commentary_83.mp3"
      },
      {
        time: "86'",
        text: "Rashford's shot saved by Ramsdale!",
        audio: "https://briwild79.github.io/football-commentary-audio/commentary_84.mp3"
      },
      {
        time: "87'",
        text: "Yellow card for Rice - time wasting",
        audio: "https://briwild79.github.io/football-commentary-audio/commentary_85.mp3"
      },
      {
        time: "88'",
        text: "Free kick in dangerous position",
        audio: "https://briwild79.github.io/football-commentary-audio/commentary_86.mp3"
      },
      {
        time: "89'",
        text: "Bruno Fernandes drives forward",
        audio: "https://briwild79.github.io/football-commentary-audio/commentary_87.mp3"
      },
      {
        time: "90'",
        text: "Final whistle blows – Arsenal take the win!",
        audio: "https://briwild79.github.io/football-commentary-audio/commentary_88.mp3"
      }
    ];

    let currentIndex = 0;
    let currentAudio = null;

    function playNextCommentary() {
      if (currentIndex >= commentaries.length) {
        commentaryLine.textContent = "All commentary played.";
        return;
      }

      const { text, audio } = commentaries[currentIndex];
      commentaryLine.textContent = text;

      currentAudio = new Audio(audio);
      currentAudio.play().then(() => {
        console.log(`Playing: ${text}`);
      }).catch(err => {
        console.error("Error playing audio:", err);
        currentIndex++;
        playNextCommentary(); // Skip to next if error
      });

      currentAudio.onended = () => {
        currentIndex++;
        playNextCommentary();
      };
    }

    playButton.addEventListener("click", () => {
      currentIndex = 0;
      if (currentAudio) {
        currentAudio.pause();
      }
      playNextCommentary();
    });
  </script>
</body>
</html>
